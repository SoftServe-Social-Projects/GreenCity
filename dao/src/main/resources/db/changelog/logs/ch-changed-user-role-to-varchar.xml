<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet author="Max Bohonko" id="1">
        <sql>
            alter table users alter column role type varchar using role::varchar;
            UPDATE users set role = 'ROLE_ADMIN' where role = '1';
            UPDATE users set role = 'ROLE_USER' where role = '0';

            create table employee_authorities
            (
                id   bigserial
                    constraint employee_authorities_pkey
                        primary key,
                name varchar(255)
            );

            create table employee_authorities_mapping
            (
                authority_id bigint not null
                    constraint fkhoy6c05kg66iogn1pmgw0djup
                        references employee_authorities,
                user_id      bigint not null
                    constraint fk4uq2ytt6y7txx8xgpp4u5r33i
                        references users
            );
        </sql>
    </changeSet>

    <changeSet author="Hanna Sakhno" id="ch-add-name-unique-constraint-Sakhno">
        <addUniqueConstraint  columnNames="name"
                              constraintName="name_unique"
                              schemaName="public"
                              tableName="employee_authorities"
        />
    </changeSet>

    <changeSet id="Korzh-5" author="Nikita Korzh">
        <insert tableName="users">
            <column name = "date_of_registration" value="1970-01-01 00:00:00.000000"/>
            <column name="email" value="pickup@nowaste.org.ua"/>
            <column name="email_notification" value="0"/>
            <column name="name" value="UBS"/>
            <column name="role" value="ROLE_UBS_EMPLOYEE"/>
            <column name="user_status" value="2"/>
            <column name="refresh_token_key" value="e59b50f5-53c2-48e5-9439-b171634ffdd0"/>
            <column name="rating" value="0"/>
            <column name="first_name" value="ADMIN"/>
            <column name="show_location" value="true"/>
            <column name="show_eco_place" value="true"/>
            <column name="show_to_do_list" value="true"/>
            <column name="language_id" value="2"/>
            <column name="uuid" value="d0840b34-3f17-4820-a375-305b855dff8b"/>
            <column name="phone_number" value="+380675554433"/>
        </insert>
    </changeSet>
</databaseChangeLog>
